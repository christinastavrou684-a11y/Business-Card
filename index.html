<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Business Card Generator</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
    <style>
        :root { --primary: #4a90e2; --secondary: #2ecc71; --share: #9b59b6; }
        
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: #2c3e50; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            padding: 20px;
        }

        .container { 
            background: #ffffff; 
            padding: 30px; 
            border-radius: 20px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.4); 
            width: 100%; 
            max-width: 450px; 
            text-align: center; 
        }

        h2 { color: #333; margin-bottom: 20px; }
        
        .input-group { margin-bottom: 15px; text-align: left; }
        label { display: block; font-size: 12px; color: #666; margin-left: 5px; margin-bottom: 2px; }
        input { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid #ddd; 
            border-radius: 10px; 
            box-sizing: border-box; 
            font-size: 14px;
            background: #f8f9fa;
        }

        .controls { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 20px; }
        
        button { 
            padding: 12px 18px; 
            border: none; 
            border-radius: 10px; 
            color: white; 
            cursor: pointer; 
            font-weight: bold; 
            transition: 0.3s; 
            flex: 1 1 45%; 
        }
        
        .btn-download { background: var(--primary); }
        .btn-qr { background: var(--secondary); }
        .btn-share { background: var(--share); width: 100%; flex: 1 1 100%; }
        .btn-reset { background: #e74c3c; width: 100%; flex: 1 1 100%; margin-top: 10px; }
        
        #preview { 
            background: white; 
            color: black; 
            padding: 25px; 
            border-radius: 15px; 
            margin-top: 25px; 
            border: 1px solid #eee; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: left; 
            position: relative; 
            min-height: 150px;
        }
        
        #preview h3 { margin: 0; font-size: 22px; min-height: 28px; }
        #preview p { margin: 5px 0; font-size: 14px; color: inherit; opacity: 0.9; min-height: 18px; }
        
        #qr-canvas { 
            margin-top: 15px; 
            display: inline-block; 
            background: white; 
            padding: 10px; 
            border-radius: 8px; 
        }
        
        .color-picker-wrapper { display: flex; align-items: center; gap: 10px; margin-top: 10px; }
        #vcard-url-box { margin-top:15px; background: #f1f2f6; padding: 15px; border-radius: 10px; border: 1px dashed #adb5bd; text-align: left; }
    </style>
</head>
<body>

<div class="container">
    <h2>Business Card Maker</h2>
    
    <div class="input-group">
        <label>ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿</label>
        <input type="text" id="name" placeholder="Î¤Î¿ ÎŒÎ½Î¿Î¼Î¬ ÏƒÎ±Ï‚" oninput="liveUpdate()">
    </div>
    <div class="input-group">
        <label>Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</label>
        <input type="text" id="phone" placeholder="+30 690 0000000" oninput="liveUpdate()">
    </div>
    <div class="input-group">
        <label>Email</label>
        <input type="email" id="email" placeholder="name@company.com" oninput="liveUpdate()">
    </div>
    <div class="input-group">
        <label>Î•Ï„Î±Î¹ÏÎµÎ¯Î± & Î˜Î­ÏƒÎ·</label>
        <input type="text" id="company" placeholder="Î•Ï„Î±Î¹ÏÎµÎ¯Î±" oninput="liveUpdate()" style="width: 48%; display: inline-block;">
        <input type="text" id="job" placeholder="Î˜Î­ÏƒÎ·" oninput="liveUpdate()" style="width: 48%; display: inline-block; float: right;">
    </div>
    <div class="input-group">
        <label>Links (LinkedIn / Website)</label>
        <input type="text" id="linkedin" placeholder="LinkedIn URL" oninput="liveUpdate()" style="margin-bottom: 5px;">
        <input type="text" id="website" placeholder="Website URL" oninput="liveUpdate()">
    </div>

    <div class="color-picker-wrapper">
        <label>Î§ÏÏÎ¼Î± ÎšÎ¬ÏÏ„Î±Ï‚:</label>
        <input type="color" id="cardColor" value="#ffffff" oninput="liveUpdate()" style="width: 50px; height: 30px; cursor: pointer; padding: 0;">
    </div>

    <div id="preview">
        <h3 id="name-preview"></h3>
        <p id="job-preview" style="font-weight: bold;"></p>
        <p id="phone-preview"></p>
        <p id="email-preview"></p>
        <div style="text-align: center;"><div id="qr-canvas"></div></div>
    </div>

    <div class="controls">
        <button onclick="handleShare()" class="btn-share">ğŸ”— Share Contact</button>
        <button onclick="downloadVCard()" class="btn-download">Download vCard</button>
        <button onclick="downloadQR()" class="btn-qr">Download QR</button>
        <button onclick="generateVCardURL()" style="background: #e67e22; width: 100%;">Get NFC Link</button>
        <button onclick="resetForm()" class="btn-reset">ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚</button>
    </div>

    <div id="vcard-url-box" style="display:none;">
        <p style="color: #333; font-size: 13px; margin: 0 0 5px 0;"><b>NFC Public URL:</b></p>
        <input type="text" id="vcard-url" readonly style="font-size: 12px; background: #fff; width: 100%; border: 1px solid #ccc; margin-bottom: 5px;">
        <button onclick="copyURL()" style="width: 100%; background: #7f8c8d; height: 35px; padding: 5px;">Copy Link</button>
    </div>
</div>

<script>
window.onload = () => {
    const fields = ['name', 'phone', 'email', 'company', 'job', 'linkedin', 'website', 'cardColor'];
    fields.forEach(field => {
        const saved = localStorage.getItem(field);
        if(saved) document.getElementById(field).value = saved;
    });
    liveUpdate();
};

function constructVCard() {
    const name = document.getElementById('name').value.trim() || "Contact";
    const phone = document.getElementById('phone').value.trim();
    const email = document.getElementById('email').value.trim();
    const company = document.getElementById('company').value.trim();
    const job = document.getElementById('job').value.trim();
    const linkedin = document.getElementById('linkedin').value.trim();
    const website = document.getElementById('website').value.trim();

    let vcard = [
        'BEGIN:VCARD',
        'VERSION:3.0',
        `N:${name};;;;`,
        `FN:${name}`,
        `ORG:${company}`,
        `TITLE:${job}`,
        `TEL;TYPE=CELL:${phone}`,
        `EMAIL;TYPE=INTERNET:${email}`
    ];
    if(linkedin) vcard.push(`URL:${linkedin}`);
    if(website) vcard.push(`URL:${website}`);
    vcard.push('END:VCARD');
    
    return vcard.join('\n');
}

function liveUpdate() {
    const data = {
        name: document.getElementById('name').value || "", 
        phone: document.getElementById('phone').value,
        email: document.getElementById('email').value,
        company: document.getElementById('company').value,
        job: document.getElementById('job').value,
        linkedin: document.getElementById('linkedin').value,
        website: document.getElementById('website').value,
        color: document.getElementById('cardColor').value
    };

    Object.keys(data).forEach(key => localStorage.setItem(key, data[key]));

    document.getElementById('name-preview').textContent = data.name;
    document.getElementById('job-preview').textContent = (data.job || data.company) ? `${data.job} @ ${data.company}` : "";
    document.getElementById('phone-preview').textContent = data.phone ? 'ğŸ“ ' + data.phone : "";
    document.getElementById('email-preview').textContent = data.email ? 'âœ‰ï¸ ' + data.email : "";

    const preview = document.getElementById('preview');
    preview.style.backgroundColor = data.color;
    const rgb = parseInt(data.color.substring(1), 16);
    const luma = 0.2126 * ((rgb >> 16) & 0xff) + 0.7152 * ((rgb >> 8) & 0xff) + 0.0722 * ((rgb >> 0) & 0xff);
    preview.style.color = luma < 128 ? 'white' : 'black';

    const qrContainer = document.getElementById("qr-canvas");
    qrContainer.innerHTML = "";
    if(data.name.trim() !== "") {
        new QRCode(qrContainer, { text: constructVCard(), width: 120, height: 120 });
    }
}

async function handleShare() {
    const name = document.getElementById('name').value.trim();
    if(!name) return alert("Î£Ï…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î±!");

    const vcardText = constructVCard();
    const file = new File([vcardText], `${name}.vcf`, { type: 'text/vcard' });

    if (navigator.canShare && navigator.canShare({ files: [file] })) {
        try {
            await navigator.share({
                files: [file],
                title: 'Î•Ï€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¹ÎºÎ® ÎšÎ¬ÏÏ„Î±',
                text: `Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚ Î³Î¹Î± ${name}`
            });
        } catch (err) {
            if (err.name !== 'AbortError') console.error('Share failed:', err);
        }
    } else {
        downloadVCard();
    }
}

function downloadVCard() {
    const name = document.getElementById('name').value.trim() || "contact";
    const blob = new Blob([constructVCard()], { type: "text/vcard" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `${name.replace(/\s+/g, "_")}.vcf`;
    a.click();
}

function generateVCardURL() {
    const name = document.getElementById('name').value.trim();
    if (!name) return alert("Î’Î¬Î»Îµ Î­Î½Î± ÏŒÎ½Î¿Î¼Î±!");
    const baseURL = "https://christinastavrou684-a11y.github.io/Business-Card/cards/"; 
    document.getElementById("vcard-url").value = baseURL + name.replace(/\s+/g, "_") + ".vcf";
    document.getElementById("vcard-url-box").style.display = "block";
}

function copyURL() {
    const copyText = document.getElementById("vcard-url");
    copyText.select();
    navigator.clipboard.writeText(copyText.value);
    alert("Î‘Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ!");
}

function downloadQR() {
    const canvas = document.querySelector("#qr-canvas canvas");
    if (!canvas) return alert("Î Î»Î·ÎºÏ„ÏÎ¿Î»Î¿Î³Î®ÏƒÏ„Îµ ÏŒÎ½Î¿Î¼Î±!");
    const a = document.createElement("a");
    a.href = canvas.toDataURL("image/png");
    a.download = "Business_QR.png";
    a.click();
}

function resetForm() {
    if(confirm("ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏŒÎ»Ï‰Î½;")) { localStorage.clear(); location.reload(); }
}
</script>
</body>
</html>
