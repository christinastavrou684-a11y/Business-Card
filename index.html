<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Card</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
    <style>
        :root { 
            --gold: #d4af37; 
            --dark-bg: #1a1a1a;
            --share: #9b59b6; 
            --nfc: #e67e22;
        }
        
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: #2c3e50; 
            display: flex; justify-content: center; align-items: center; 
            min-height: 100vh; margin: 0; padding: 20px;
        }

        .container { 
            background: #ffffff; padding: 30px; border-radius: 20px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.4); 
            width: 100%; max-width: 450px; text-align: center; 
        }

        .input-group { margin-bottom: 12px; text-align: left; }
        label { display: block; font-size: 11px; color: #666; margin-bottom: 2px; font-weight: bold; }
        input { 
            width: 100%; padding: 10px; border: 1px solid #ddd; 
            border-radius: 8px; font-size: 14px; background: #f8f9fa; box-sizing: border-box;
        }

        /* VIP Gold Preview */
        #preview { 
            background: var(--dark-bg); 
            color: var(--gold); 
            padding: 25px; border-radius: 15px; 
            margin-top: 25px; border: 2px solid var(--gold); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            text-align: left;
        }
        
        #preview h3 { margin: 0; font-size: 24px; border-bottom: 1px solid rgba(212, 175, 55, 0.3); padding-bottom: 5px; }
        #preview p { margin: 8px 0; font-size: 14px; color: #ffffff; opacity: 0.9; }

        #qr-canvas { 
            margin-top: 15px; display: inline-block; 
            background: white; padding: 10px; border-radius: 8px; 
        }

        .controls { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px; }
        button { 
            padding: 14px; border: none; border-radius: 10px; 
            color: white; cursor: pointer; font-weight: bold; transition: 0.2s; flex: 1 1 100%; 
            font-size: 15px;
        }
        
        .btn-share { background: var(--share); }
        .btn-nfc { background: var(--nfc); }
        .btn-reset { background: #e74c3c; margin-top: 10px; opacity: 0.8; }
        
        #vcard-url-box { 
            margin-top:15px; background: #f1f2f6; padding: 15px; 
            border-radius: 10px; border: 1px dashed #adb5bd; 
        }
    </style>
</head>
<body>

<div class="container">
    <h2 style="color:#333; margin-top:0;">Business Card</h2>
    
    <div class="input-group">
        <label>ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿</label>
        <input type="text" id="name" placeholder="Î¤Î¿ ÎŒÎ½Î¿Î¼Î¬ ÏƒÎ±Ï‚" oninput="liveUpdate()">
    </div>
    <div class="input-group">
        <label>Î¤Î·Î»Î­Ï†Ï‰Î½Î¿ & Email</label>
        <input type="text" id="phone" placeholder="+30 69..." oninput="liveUpdate()" style="width:48%">
        <input type="email" id="email" placeholder="Email" oninput="liveUpdate()" style="width:48%; float:right;">
    </div>
    <div class="input-group">
        <label>Î•Ï„Î±Î¹ÏÎµÎ¯Î± & Î˜Î­ÏƒÎ·</label>
        <input type="text" id="company" placeholder="Î•Ï„Î±Î¹ÏÎµÎ¯Î±" oninput="liveUpdate()" style="width:48%">
        <input type="text" id="job" placeholder="Î˜Î­ÏƒÎ·" oninput="liveUpdate()" style="width:48%; float:right;">
    </div>
    <div class="input-group">
        <label>Links</label>
        <input type="text" id="linkedin" placeholder="LinkedIn URL" oninput="liveUpdate()" style="margin-bottom: 5px;">
        <input type="text" id="website" placeholder="Website URL" oninput="liveUpdate()">
    </div>

    <div id="preview">
        <h3 id="name-preview"></h3>
        <p id="job-preview" style="font-weight: bold;"></p>
        <p id="phone-preview"></p>
        <p id="email-preview"></p>
        <div style="text-align: center;"><div id="qr-canvas"></div></div>
    </div>

    <div class="controls">
        <button onclick="handleShare()" class="btn-share"> Share Contact </button>
        <button onclick="generateVCardURL()" class="btn-nfc"> Get NFC Link</button>
        <button onclick="resetForm()" class="btn-reset">ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÎŒÎ»Ï‰Î½</button>
    </div>

    <div id="vcard-url-box" style="display:none;">
        <p style="font-size: 12px; margin-bottom: 5px; color: #444;">NFC Public Link:</p>
        <input type="text" id="vcard-url" readonly style="width:100%; margin-bottom:10px; padding:8px; border:1px solid #ccc; font-size: 12px;">
        <button onclick="copyURL()" style="background:#7f8c8d; padding: 8px;">Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î® Link</button>
    </div>
</div>

<script>
window.onload = () => {
    ['name', 'phone', 'email', 'company', 'job', 'linkedin', 'website'].forEach(f => {
        const saved = localStorage.getItem(f);
        if(saved) document.getElementById(f).value = saved;
    });
    liveUpdate();
};

function constructVCard() {
    const name = document.getElementById('name').value.trim() || "Contact";
    const phone = document.getElementById('phone').value.trim();
    const email = document.getElementById('email').value.trim();
    const company = document.getElementById('company').value.trim();
    const job = document.getElementById('job').value.trim();
    const linkedin = document.getElementById('linkedin').value.trim();
    const website = document.getElementById('website').value.trim();

    let vcard = [`BEGIN:VCARD`, `VERSION:3.0`, `N:${name};;;;`, `FN:${name}`, `ORG:${company}`, `TITLE:${job}`, `TEL:${phone}`, `EMAIL:${email}`];
    if(linkedin) vcard.push(`URL:${linkedin}`);
    if(website) vcard.push(`URL:${website}`);
    vcard.push(`END:VCARD`);
    return vcard.join('\n');
}

function liveUpdate() {
    const fields = ['name', 'phone', 'email', 'company', 'job', 'linkedin', 'website'];
    fields.forEach(f => localStorage.setItem(f, document.getElementById(f).value));

    document.getElementById('name-preview').textContent = document.getElementById('name').value;
    document.getElementById('job-preview').textContent = (document.getElementById('job').value || document.getElementById('company').value) ? 
        `${document.getElementById('job').value} @ ${document.getElementById('company').value}` : "";
    document.getElementById('phone-preview').textContent = document.getElementById('phone').value ? 'ğŸ“ ' + document.getElementById('phone').value : "";
    document.getElementById('email-preview').textContent = document.getElementById('email').value ? 'âœ‰ï¸ ' + document.getElementById('email').value : "";

    const qrContainer = document.getElementById("qr-canvas");
    qrContainer.innerHTML = "";
    if(document.getElementById('name').value.trim() !== "") {
        new QRCode(qrContainer, { text: constructVCard(), width: 130, height: 130 });
    }
}

async function handleShare() {
    const name = document.getElementById('name').value.trim();
    if(!name) return alert("Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î±!");
    
    const vcardText = constructVCard();
    const file = new File([vcardText], `${name}.vcf`, { type: 'text/vcard' });

    if (navigator.canShare && navigator.canShare({ files: [file] })) {
        try {
            await navigator.share({
                files: [file],
                title: 'Î•Ï€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¹ÎºÎ® Î•Ï€Î±Ï†Î®',
                text: `Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Î³Î¹Î± ${name}`
            });
        } catch (err) {
            if (err.name !== 'AbortError') console.error('Error:', err);
        }
    } else {
        const blob = new Blob([vcardText], { type: "text/vcard" });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = `${name}.vcf`;
        a.click();
    }
}

function generateVCardURL() {
    const name = document.getElementById('name').value.trim();
    if (!name) return alert("Î’Î¬Î»Îµ Î­Î½Î± ÏŒÎ½Î¿Î¼Î±!");
    const baseURL = "https://christinastavrou684-a11y.github.io/Business-Card/cards/"; 
    document.getElementById("vcard-url").value = baseURL + name.replace(/\s+/g, "_") + ".vcf";
    document.getElementById("vcard-url-box").style.display = "block";
}

function copyURL() {
    const copyText = document.getElementById("vcard-url");
    copyText.select();
    navigator.clipboard.writeText(copyText.value);
    alert("Î¤Î¿ Link Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ!");
}

function resetForm() {
    if(confirm("Î˜Î­Î»ÎµÏ„Îµ Î½Î± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎµÏ„Îµ ÏŒÎ»Î± Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±;")) {
        localStorage.clear();
        location.reload();
    }
}
</script>
</body>
</html>
